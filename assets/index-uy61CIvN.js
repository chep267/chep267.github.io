import{r as c,h as k,j as i,R as S,S as _,H as j,a_ as Q,a3 as w,P as q,J as A,aa as N,F as L,as as Z,Y as U}from"./index-3bWkHj16.js";import{u as W}from"./useCountdown-nkBSuZ9j.js";import{g as G}from"./MainRoute-INgURMcV.js";import"./baseMessage-3oRVXsgW.js";import"./isMuiElement-GriJZeF9.js";const z={easy:{row:7,col:14,duration:180,point:7*14},normal:{row:9,col:16,duration:240,point:9*16},hard:{row:10,col:20,duration:360,point:10*20}},ee=36,te=(t,n)=>t.some(e=>e.x===n.x&&e.y===n.y),ne=t=>{const{row:n,col:e}=z[t],s=Array.from({length:n},(o,m)=>Array.from({length:e},(l,g)=>({x:m,y:g,value:0}))),a=()=>Math.floor(Math.random()*ee)+1,r=n*e;for(let o=0,m=0;o<n;++o){for(let l=0;l<e;++l){++m;const g=n-1-o,d=e-1-l,M=a();if(s[o][l]={x:o,y:l,value:M},s[g][d]={x:g,y:d,value:M},m>=r/2)break}if(m>=r/2)break}for(let o=0;o+1<n;++o)for(let m=0;m+2<e;++m){const l=s[o][m].value;s[o][m].value=s[o+1][m].value,s[o+1][m].value=l}for(let o=0;o+1<e;++o)for(let m=0;m+2<n;++m){const l=s[m][o].value;s[m][o].value=s[m][o+1].value,s[m][o+1].value=l}return s},u=(t,n,e)=>{var s,a;return!!((a=(s=t==null?void 0:t[n])==null?void 0:s[e])!=null&&a.value)||!1},x=(t,n,e,s)=>{const a=Math.max(e,s),r=Math.min(e,s);for(let o=r;o<=a;++o)if(u(t,n,o))return!1;return!0},y=(t,n,e,s)=>{const a=Math.max(e,s),r=Math.min(e,s);for(let o=r;o<=a;++o)if(u(t,o,n))return!1;return!0},oe=(t,n,e)=>{const s=Math.max(n.x,e.x),a=Math.min(n.x,e.x),r=Math.max(n.y,e.y),o=Math.min(n.y,e.y);return n.x===e.x?o+1===r||x(t,n.x,o+1,r-1):n.y===e.y?a+1===s||y(t,n.y,a+1,s-1):!1},se=(t,n,e)=>{if(u(t,n.x-1,n.y))return!1;const s=Math.min(n.x,e.x),a=Math.max(n.y,e.y),r=Math.min(n.y,e.y);if(!u(t,e.x-1,e.y)){for(let o=s-1;o>=-1;--o)if(y(t,n.y,n.x-1,o)&&y(t,e.y,e.x-1,o)&&x(t,o,r+1,a-1))return!0}if(n.x>e.x+1&&!u(t,e.x+1,e.y)){for(let o=n.x-1;o>e.x;--o)if(y(t,n.y,n.x-1,o)&&y(t,e.y,e.x+1,o)&&x(t,o,r+1,a-1))return!0}return!!(n.x>e.x&&(!u(t,e.x,e.y-1)||!u(t,e.x,e.y+1))&&y(t,n.y,n.x-1,e.x)&&(r+1===a||x(t,e.x,r+1,a-1)))},ae=(t,n,e)=>{if(u(t,n.x+1,n.y))return!1;const s=Math.max(n.x,e.x),a=Math.max(n.y,e.y),r=Math.min(n.y,e.y);if(!u(t,e.x+1,e.y)){for(let o=s+1;o<=t.length;++o)if(y(t,n.y,n.x+1,o)&&y(t,e.y,e.x+1,o)&&x(t,o,r+1,a-1))return!0}if(n.x+1<e.x&&!u(t,e.x-1,e.y)){for(let o=n.x+1;o<e.x;++o)if(y(t,n.y,n.x+1,o)&&y(t,e.y,e.x-1,o)&&x(t,o,r+1,a-1))return!0}return!!(n.x<e.x&&!u(t,e.x,e.y-1)&&y(t,n.y,n.x+1,e.x)&&(r+1===a||x(t,e.x,r+1,a-1)))},me=(t,n,e)=>{if(u(t,n.x,n.y-1))return!1;const s=Math.max(n.x,e.x),a=Math.min(n.x,e.x),r=Math.max(n.y,e.y),o=Math.min(n.y,e.y);if(!u(t,e.x,e.y-1)){for(let m=o-1;m>=-1;--m)if(y(t,m,a+1,s-1)&&x(t,n.x,n.y-1,m)&&x(t,e.x,e.y-1,m))return!0}if(n.y>e.y+1&&!u(t,e.x,e.y+1)){for(let m=o+1;m<r;++m)if(y(t,m,a+1,s-1)&&x(t,n.x,n.y-1,m)&&x(t,e.x,e.y+1,m))return!0}return!!(n.y>e.y&&(!u(t,e.x-1,e.y)||!u(t,e.x+1,e.y))&&x(t,n.x,n.y-1,e.y)&&(a+1===s||y(t,e.y,a+1,s-1)))},re=(t,n,e)=>{if(u(t,n.x,n.y+1))return!1;const s=Math.max(n.x,e.x),a=Math.min(n.x,e.x),r=Math.max(n.y,e.y),o=Math.min(n.y,e.y);if(!u(t,e.x,e.y+1)){for(let m=r+1;m<=t[0].length;++m)if(y(t,m,a+1,s-1)&&x(t,n.x,n.y+1,m)&&x(t,e.x,e.y+1,m))return!0}if(n.y+1<e.y&&!u(t,e.x,e.y-1)){for(let m=o+1;m<r;++m)if(y(t,m,a+1,s-1)&&x(t,n.x,n.y+1,m)&&x(t,e.x,e.y-1,m))return!0}return!!(n.y<e.y&&(!u(t,e.x-1,e.y)||!u(t,e.x+1,e.y))&&x(t,n.x,n.y+1,e.y)&&(a+1===s||y(t,e.y,a+1,s-1)))},ie=(t,n)=>{const e=n[0],s=n[1];return n.length<2||!e||!s||e.value!==s.value?!1:oe(t,e,s)||se(t,e,s)||ae(t,e,s)||me(t,e,s)||re(t,e,s)},le=(t,n)=>{const e=document.getElementById(`pokemon-item-${t}-${n}`);if(!e)return;const s=e.getBoundingClientRect(),a=s.left+window.scrollX,r=s.top+window.scrollY;return{posX:a,posY:r}},f={GameLevel:z,isItemInArray:te,genBoardGame:ne,hasPruneItem:ie,getItemPosition:le},v={boardGame:[],items:[],status:"pending",level:"easy",duration:f.GameLevel.easy.duration,gameKey:1,point:0},B=c.createContext({data:v,method:{initGame:k,stopGame:k,restartGame:k,nextGame:k,chooseItem:k,getItemStatus:()=>"select"}});B.displayName="PokemonContext";function ce(t){const{children:n}=t,[e,s]=c.useState(v.status),[a,r]=c.useState(v.level),[o,m]=c.useState(v.boardGame),[l,g]=c.useState(v.items),[d,M]=c.useState("select"),[C,X]=c.useState(v.point),[Y,O]=c.useState(v.gameKey),$=W({numberCountdown:0});c.useEffect(()=>{E(a),X(0)},[Y]),c.useEffect(()=>{C>=f.GameLevel[a].point&&s("next")},[C]),c.useEffect(()=>{$.second===0&&e==="start"&&s("stop")},[$.second]),c.useEffect(()=>{const p=l.length>1?f.hasPruneItem(o,l)?"success":"error":"select";if(p==="error")setTimeout(()=>{g([])},1e3);else if(p==="success"){const h=l[0],D=l[1];setTimeout(()=>{m(J=>{const P=[...J];return P[h.x][h.y].value=0,P[D.x][D.y].value=0,P}),g([])},1e3)}M(p),p==="success"&&setTimeout(()=>X(h=>h+2),1200)},[l]);const E=c.useCallback(p=>{r(p),m(f.genBoardGame(p)),s("start"),$.onRefresh(f.GameLevel[p].duration)},[]),R=c.useCallback(()=>{O(p=>(p+1)%7)},[]),T=c.useCallback(()=>{r(p=>p==="easy"?"normal":"hard"),O(p=>(p+1)%7)},[]),V=c.useCallback(()=>{},[]),b=c.useCallback(p=>{g(h=>h.length===2?h:f.isItemInArray(h,p)?[]:[...h,p])},[]),H=p=>f.isItemInArray(l,p)?d:void 0,F=c.useMemo(()=>({data:{boardGame:o,items:l,status:e,level:a,duration:f.GameLevel[a].duration,gameKey:Y,point:C},method:{initGame:E,restartGame:R,stopGame:V,chooseItem:b,nextGame:T,getItemStatus:H}}),[e,o,l,a,d,C]);return i.jsx(B.Provider,{value:F,children:n})}const ue={boardGame:[],items:[],status:"pending",level:"easy",duration:f.GameLevel.easy.duration,gameKey:1,point:0},K=c.createContext({data:ue,method:{initGame:k,stopGame:k,restartGame:k,nextGame:k,chooseItem:k,getItemStatus:()=>"select"}});K.displayName="PokemonContext";const I=()=>c.useContext(K),pe=S({"@keyframes timing":{"0%":{width:"100%"},"100%":{width:"0%"}},line:{position:"relative",width:"100%",height:4,borderRadius:20,backgroundImage:"linear-gradient(to right, red,orange,yellow,green)","&:before":{content:'""',position:"absolute",borderRadius:20,top:0,left:0,bottom:0,animationTimingFunction:"linear"}},lineStart:{backgroundImage:"none","&:before":{backgroundImage:"linear-gradient(to right, red,orange,yellow,green)",animationName:"$timing"}},lineStop:{opacity:.2}});var xe=pe;function ye(t){const{className:n}=t,e=xe(),{data:{duration:s,status:a}}=I();return i.jsx(_,{className:j(e.line,n,{[e.lineStart]:a==="start"},{[e.lineStop]:a==="stop"}),sx:{"&:before":{animationDuration:`${s}s`}}})}const ge="/assets/pokemon_1-_rwUpLef.png",ke="/assets/pokemon_2-uXJvS91b.png",he="/assets/pokemon_3-mLLpcdTD.png",fe="/assets/pokemon_4-p_ikc5x7.png",_e="/assets/pokemon_5-X60QDdXd.png",ve="/assets/pokemon_6-aqxAMXVA.png",Ge="/assets/pokemon_7-kxyGQ0HX.png",Se="/assets/pokemon_8-dgOiZzz8.png",je="/assets/pokemon_9-qOnlIO1v.png",de="/assets/pokemon_10-YXaNhRDn.png",we="/assets/pokemon_11-dDshKojj.png",Ie="/assets/pokemon_12-eZBPF1Yj.png",Me="/assets/pokemon_13-kCHf7t0k.png",Ce="/assets/pokemon_14-y8nGngTm.png",$e="/assets/pokemon_15-8fL3T8jd.png",Pe="/assets/pokemon_16-FeLEj9Vi.png",Ne="/assets/pokemon_17-4AC_4Kf9.png",Le="/assets/pokemon_18-amt3sHif.png",Xe="/assets/pokemon_19-KAg0SO50.png",Ye="/assets/pokemon_20-yJYHxrQb.png",Oe="/assets/pokemon_21-X25cynzf.png",Ee="/assets/pokemon_22-pgYGII2W.png",De="/assets/pokemon_23-r2mGVv-R.png",Ae="/assets/pokemon_24-ZDgsg9zc.png",ze="/assets/pokemon_25-87joVjIe.png",Be="/assets/pokemon_26-LlDn7Bd3.png",Ke="/assets/pokemon_27-Zg4Q78nj.png",Re="/assets/pokemon_28-MC9YpkJ9.png",Te="/assets/pokemon_29-EncL34BO.png",Ve="/assets/pokemon_30-qpLme0Ks.png",be="/assets/pokemon_31-ctjLe5GQ.png",He="/assets/pokemon_32-lhL1r2sL.png",Fe="/assets/pokemon_33-qt732usg.png",Je="/assets/pokemon_34-1DwBihNu.png",Qe="/assets/pokemon_35-0tVEJMTg.png",qe="/assets/pokemon_36-pwSrGvGN.png",Ze=Object.freeze({1:ge,2:ke,3:he,4:fe,5:_e,6:ve,7:Ge,8:Se,9:je,10:de,11:we,12:Ie,13:Me,14:Ce,15:$e,16:Pe,17:Ne,18:Le,19:Xe,20:Ye,21:Oe,22:Ee,23:De,24:Ae,25:ze,26:Be,27:Ke,28:Re,29:Te,30:Ve,31:be,32:He,33:Fe,34:Je,35:Qe,36:qe}),Ue=S(({palette:t})=>({"@keyframes success":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.9)"},"100%":{transform:"scale(1)"}},"@keyframes error":{"10%, 90%":{transform:"translate3d(-1px, 0, 0)"},"20%, 80%":{transform:"translate3d(2px, 0, 0)"},"30%, 50%, 70%":{transform:"translate3d(-4px, 0, 0)"},"40%, 60%":{transform:"translate3d(4px, 0, 0)"}},item:{width:50,height:70,borderRadius:2,backgroundSize:"cover",backgroundRepeat:"no-repeat","&:hover":{opacity:.8}},itemEmpty:{"&:hover":{background:"unset",cursor:"default"}},itemSelected:{position:"relative",opacity:.6,"&:after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:1,border:"4px solid",borderColor:t.success.main,opacity:2}},itemError:{animation:"$error 1s linear infinite","&:after":{borderColor:t.error.main}},itemSuccess:{opacity:"1 !important",animation:"$success 1s linear infinite"}}));var We=Ue;function et(t){const{id:n,status:e,item:s,onSelect:a}=t,r=We(),o=s.value===0,m=c.useMemo(()=>o?Q:{backgroundImage:`url(${Ze[s.value]})`},[o]);return i.jsx(w,{id:n,disabled:o,className:j(r.item,{[r.itemEmpty]:o},{[r.itemSelected]:e==="select"||e==="success"||e==="error"},{[r.itemError]:e==="error"},{[r.itemSuccess]:e==="success"}),style:m,onClick:()=>a(s)})}const tt=S({board:{display:"flex",flexDirection:"column",width:"auto",height:"auto",borderRadius:6,gap:1,padding:10},row:{flexDirection:"row",gap:1}});var nt=tt;function ot(t){const{className:n}=t,e=nt(),{data:s,method:a}=I();return i.jsx(q,{className:j(e.board,n),children:s.boardGame.map((r,o)=>i.jsx(_,{className:e.row,children:r.map((m,l)=>{const g=a.getItemStatus(m);return i.jsx(et,{id:`pokemon-item-${o}-${l}`,status:g,item:m,onSelect:a.chooseItem},`boardGame-${s.gameKey}-row-${o}-col-${l}`)})},`boardGame-${s.gameKey}-row-${o}`))})}const st=S(({palette:t,zIndex:n,spacing:e})=>({gameOver:{position:"absolute",alignItems:"center",justifyContent:"center",zIndex:-1,top:0,left:0,right:0,bottom:0,backgroundColor:A(t.background.default,.8),visibility:"hidden",gap:e(2)},gameOverShow:{zIndex:n.drawer,visibility:"visible"}}));var at=st;function mt(t){const{className:n}=t,e=at(),{data:s,method:a}=I(),{formatMessage:r}=N();return i.jsxs(_,{className:j(e.gameOver,{[e.gameOverShow]:s.status==="stop"},n),children:[i.jsx(L,{variant:"h1",color:"warning.main",textAlign:"center",children:r(G["module.game.pokemon.text.game.over"])}),i.jsxs(_,{direction:"row",gap:2,children:[i.jsx(w,{variant:"outlined",onClick:a.restartGame,children:r(G["module.game.pokemon.button.restart"])}),i.jsx(Z,{to:U.GAME,children:i.jsx(w,{variant:"outlined",color:"error",children:r(G["module.game.pokemon.button.exit"])})})]})]})}const rt=S(({palette:t,zIndex:n,spacing:e})=>({gameVictory:{position:"absolute",alignItems:"center",justifyContent:"center",zIndex:-1,top:0,left:0,right:0,bottom:0,backgroundColor:A(t.background.default,.8),visibility:"hidden",gap:e(2)},gameVictoryShow:{zIndex:n.drawer,visibility:"visible"}}));var it=rt;function lt(t){const{className:n}=t,e=it(),{data:s,method:a}=I(),{formatMessage:r}=N();return i.jsxs(_,{className:j(e.gameVictory,{[e.gameVictoryShow]:s.status==="next"},n),children:[i.jsx(L,{variant:"h1",color:"warning.main",textAlign:"center",children:r(G["module.game.pokemon.text.game.victory"])}),i.jsxs(_,{direction:"row",gap:2,children:[i.jsx(w,{variant:"outlined",onClick:a.restartGame,children:r(G["module.game.pokemon.button.restart"])}),i.jsx(w,{variant:"outlined",color:"success",onClick:a.nextGame,children:r(G["module.game.pokemon.button.next"])})]})]})}const ct=S({point:{}});var ut=ct;function pt(t){const{className:n}=t,{formatMessage:e}=N(),s=ut(),{data:{point:a}}=I();return i.jsx(L,{className:j(s.point,n),variant:"h4",color:"primary.main",children:e(G["module.game.pokemon.text.game.point"],{point:a})})}const xt=S(({spacing:t})=>({screen:{position:"relative",width:"100%",height:"100%",alignItems:"center",overflow:"auto"},header:{flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"space-between",height:100,minHeight:100,gap:t(2),padding:`0 ${t(2)}`},lineDuration:{width:"70%"},body:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",overflow:"auto",padding:t(1.5)},boardGame:{overflow:"auto",maxWidth:`calc(100% - ${t(3)})`,maxHeight:"100%"}}));var yt=xt;function vt(){const t=yt();return i.jsx(ce,{children:i.jsxs(_,{className:t.screen,children:[i.jsxs(_,{className:t.header,children:[i.jsx(ye,{className:t.lineDuration}),i.jsx(pt,{})]}),i.jsx(_,{className:t.body,children:i.jsx(ot,{className:t.boardGame})}),i.jsx(mt,{}),i.jsx(lt,{})]})})}export{vt as default};
